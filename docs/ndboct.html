<!doctype html><html><head><meta charset='utf-8'>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.4.1/github-markdown.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/default.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.8.3/katex.min.css">
<link rel="stylesheet" href="https://gitcdn.xyz/repo/goessner/mdmath/master/css/texmath.css">
<link rel="stylesheet" href="https://gitcdn.xyz/repo/goessner/mdmath/master/css/vscode-texmath.css">

</head><body class="markdown-body">
<style>
body {
    max-width: 704px;
    margin: auto;
    padding: 32px 8px;
}

code {
    overflow-x: scroll;
    overflow-y: hidden;
    white-space: pre;
}

.katex {
    font-size: 1.3em !important;
}
</style>
<h1 data-line="19" class="code-line" id="n-dboct%E3%81%AE%E3%82%B9%E3%83%AD%E3%83%BC%E3%83%97%E3%82%92%E6%8C%81%E3%81%A4%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF">n dB/octのスロープを持つフィルタ</h1>
<p data-line="20" class="code-line">n dB/oct のスロープを持つフィルタを設計します。</p>
<figure>
<img src="img/ndboct/fir_filter_n_dB_oct.png" alt="Image of the filter with n dB/oct slope." style="width: 300px; padding-bottom: 12px;"/>
</figure>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>A</mi><mo>(</mo><mi>ω</mi><mo>)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>(</mo><mi>l</mi><mi mathvariant="normal">/</mi><mi>h</mi><msup><mo>)</mo><mi>M</mi></msup><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>(</mo><mo>−</mo><mi>π</mi><mo>≤</mo><mi>ω</mi><mo>≤</mo><mo>−</mo><mi>h</mi><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>(</mo><mi>ω</mi><mi mathvariant="normal">/</mi><mi>l</mi><msup><mo>)</mo><mi>M</mi></msup><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>(</mo><mo>−</mo><mi>h</mi><mo>&lt;</mo><mi>ω</mi><mo>&lt;</mo><mo>−</mo><mi>l</mi><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>(</mo><mo>−</mo><mi>l</mi><mo>≤</mo><mi>ω</mi><mo>≤</mo><mi>l</mi><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>(</mo><mi>ω</mi><mi mathvariant="normal">/</mi><mi>l</mi><msup><mo>)</mo><mi>M</mi></msup><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>(</mo><mi>l</mi><mo>&lt;</mo><mi>ω</mi><mo>&lt;</mo><mi>h</mi><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>(</mo><mi>l</mi><mi mathvariant="normal">/</mi><mi>h</mi><msup><mo>)</mo><mi>M</mi></msup><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>(</mo><mi>h</mi><mo>≤</mo><mi>ω</mi><mo>≤</mo><mi>π</mi><mo>)</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>M</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mspace width="0.16667em"></mspace><mi>m</mi></mrow><mrow><mn>2</mn><mn>0</mn></mrow></mfrac></mrow><msub><mi>log</mi><mn>2</mn></msub><mn>1</mn><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\begin{aligned}
A(\omega) &amp;=
\begin{cases}
(l/h)^{M}, &amp;  (-\pi \leq \omega \leq -h) \\
(\omega/l)^{M}, &amp;  (-h \lt \omega \lt -l) \\
1, &amp; (-l \leq \omega \leq l) \\
(\omega/l)^{M}, &amp; (l \lt \omega \lt h) \\
(l/h)^{M}, &amp; (h \leq \omega \leq \pi)
\end{cases} \\\\
M &amp;= {{\,m}\over{20}}\log_2 10
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:5.7968em;"></span><span class="strut bottom" style="height:11.0936em;vertical-align:-5.2968em;"></span><span class="base"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.7968em;"><span style="top:-7.7968em;"><span class="pstrut" style="height:5.85002em;"></span><span class="mord"><span class="mord mathit">A</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span></span></span><span style="top:-3.30678em;"><span class="pstrut" style="height:5.85002em;"></span><span class="mord"></span></span><span style="top:-1.5392199999999998em;"><span class="pstrut" style="height:5.85002em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.2968em;"></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.7968em;"><span style="top:-7.7968em;"><span class="pstrut" style="height:5.85002em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.8500199999999998em;"><span style="top:-0.6999900000000001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-0.6999900000000001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-0.9999899999999999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.29999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.59999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.89999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-2.19999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-3.1500100000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.30001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.60001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.90001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.200010000000001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.50001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.80001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-6.100019999999999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.3500199999999998em;"></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.8500000000000005em;"><span style="top:-5.850000000000001em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathrm">/</span><span class="mord mathit">h</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span></span></span><span style="top:-4.410000000000001em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mord mathrm">/</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span></span></span><span style="top:-2.9700000000000006em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathrm">1</span><span class="mpunct">,</span></span></span><span style="top:-1.5300000000000002em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mord mathrm">/</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span></span></span><span style="top:-0.08999999999999997em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathrm">/</span><span class="mord mathit">h</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.35em;"></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.8500000000000005em;"><span style="top:-5.850000000000001em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">−</span><span class="mord mathit" style="margin-right:0.03588em;">π</span><span class="mrel">≤</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mrel">≤</span><span class="mord">−</span><span class="mord mathit">h</span><span class="mclose">)</span></span></span><span style="top:-4.410000000000001em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">−</span><span class="mord mathit">h</span><span class="mrel">&lt;</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mrel">&lt;</span><span class="mord">−</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mclose">)</span></span></span><span style="top:-2.9700000000000006em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">−</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mrel">≤</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mrel">≤</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mclose">)</span></span></span><span style="top:-1.5300000000000002em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mrel">&lt;</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mrel">&lt;</span><span class="mord mathit">h</span><span class="mclose">)</span></span></span><span style="top:-0.08999999999999997em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathit">h</span><span class="mrel">≤</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mrel">≤</span><span class="mord mathit" style="margin-right:0.03588em;">π</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.35em;"></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.5392199999999998em;"><span class="pstrut" style="height:5.85002em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">2</span><span class="mord mathrm">0</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"></span></span></span></span></span><span class="mord mathrm">1</span><span class="mord mathrm">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.2968em;"></span></span></span></span></span></span></span></span></span></span></eqn></section><h2 data-line="40" class="code-line" id="%E9%80%86%E9%9B%A2%E6%95%A3%E3%83%95%E3%83%BC%E3%83%AA%E3%82%A8%E5%A4%89%E6%8F%9B%E3%82%92%E4%BD%BF%E3%81%86%E6%96%B9%E6%B3%95">逆離散フーリエ変換を使う方法</h2>
<p data-line="41" class="code-line"><a href="https://en.wikipedia.org/wiki/Discrete_Fourier_transform">逆離散フーリエ変換（IDFT）</a>を使って楽に設計します。</p>
<p data-line="43" class="code-line">コードを順番にPython3のインタープリタにコピペしていけば動作します。別ページでまとめて見ることもできます。</p>
<ul>
<li data-line="45" class="code-line"><a href="https://github.com/ryukau/filter_notes/blob/master/ndboct.py">n dB/octのフィルタを作るコード (github.com)</a></li>
</ul>
<p data-line="47" class="code-line"><a href="https://www.scipy.org/">SciPy</a>、<a href="http://www.numpy.org/">NumPy</a>、<a href="https://matplotlib.org/tutorials/introductory/pyplot.html">Matplotlib</a>を import します。</p>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> p
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">from</span> scipy <span class="hljs-keyword">import</span> signal
<span class="hljs-keyword">from</span> scipy.fftpack <span class="hljs-keyword">import</span> *
</div></code></pre>
<p data-line="56" class="code-line">プロットに使う関数を用意します。</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">showResponse</span><span class="hljs-params">(sample_rate, sig)</span>:</span>
    <span class="hljs-comment"># sig の周波数成分を dB に変換してプロット。</span>
    res = fftshift(fft(sig, <span class="hljs-number">2</span>**<span class="hljs-number">16</span>) / (len(sig) / <span class="hljs-number">2.0</span>))
    gain = np.array_split(
        <span class="hljs-number">20</span> * np.log10(abs(res / np.max(abs(res)))),
        <span class="hljs-number">2</span>,
    )[<span class="hljs-number">0</span>][::<span class="hljs-number">-1</span>]
    freq = getFreq(sample_rate, gain)
    p.plot(freq, gain)
    p.grid(which=<span class="hljs-string">'both'</span>)
    p.show()

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getFreq</span><span class="hljs-params">(sample_rate, spec)</span>:</span>
    <span class="hljs-comment"># 出力はプロットのx軸に使う。</span>
    freq_step = sample_rate / <span class="hljs-number">2</span> / (len(spec) - <span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> [i * freq_step <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, len(spec))]

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">toDecibel</span><span class="hljs-params">(spec)</span>:</span>
    <span class="hljs-keyword">return</span> [<span class="hljs-number">20</span> * np.log10(v) <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> spec]
</div></code></pre>
<p data-line="80" class="code-line">欲しい周波数特性を用意します。</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">makeFrequencySpecification</span><span class="hljs-params">(sample_rate, length, low, high, slope)</span>:</span>
    <span class="hljs-comment"># slope は負の値。単位は[dB/oct]。</span>
    <span class="hljs-comment"># low, high は周波数[Hz]。</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># dB/oct を算出する式の解説。</span>
    <span class="hljs-comment"># https://femci.gsfc.nasa.gov/random/randomequations.html</span>
    <span class="hljs-comment">#</span>
    <span class="hljs-comment"># 6.020599913279624 = 20 * np.log10(2)</span>
    <span class="hljs-comment">#</span>
    oct = (high / low)**(slope / <span class="hljs-number">6.020599913279624</span>)
    spec = [<span class="hljs-number">0</span>] * length
    freq_step = sample_rate / <span class="hljs-number">2</span> / (length - <span class="hljs-number">1</span>)
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, len(spec)):
        freq = i * freq_step
        <span class="hljs-keyword">if</span> freq &lt;= low:
            spec[i] = <span class="hljs-number">1</span>
        <span class="hljs-keyword">elif</span> freq &gt;= high:
            spec[i] = oct
        <span class="hljs-keyword">else</span>:
            spec[i] = (freq / low)**(slope / <span class="hljs-number">6.020599913279624</span>)
    <span class="hljs-keyword">return</span> spec


sample_rate = <span class="hljs-number">44100</span>
spec = makeFrequencySpecification(sample_rate, <span class="hljs-number">1024</span>, <span class="hljs-number">100</span>, <span class="hljs-number">10000</span>, <span class="hljs-number">-10</span>)

<span class="hljs-comment"># 設計した特性をプロット。</span>
spec_db = toDecibel(spec)
freq = getFreq(sample_rate, spec)

p.title(<span class="hljs-string">'Specification'</span>)
p.plot(freq, spec_db)
p.xscale(<span class="hljs-string">'log'</span>)
p.grid(which=<span class="hljs-string">'both'</span>)
p.show()
</div></code></pre>
<p data-line="120" class="code-line">ここでは100Hzから10000Hz間において、-10dB/octの傾きで減衰する、窓長1024の特性を作りました。</p>
<figure>
<img src="img/ndboct/n_dB_oct_spec.png" alt="Image of filter specification." style="width: 480px;"/>
</figure>
<p data-line="126" class="code-line">フィルタ係数を出します。</p>
<pre class="hljs"><code><div>filt = fftshift(ifft(spec + spec[::<span class="hljs-number">-1</span>]))

<span class="hljs-comment"># フィルタ係数の見た目。</span>
p.title(<span class="hljs-string">'Filter Coefficients'</span>)
p.plot(filt)
p.show()

<span class="hljs-comment"># フィルタの周波数応答。</span>
p.title(<span class="hljs-string">'Frequency Response of the filter'</span>)
p.xscale(<span class="hljs-string">'log'</span>)
showResponse(sample_rate, filt)
</div></code></pre>
<p data-line="142" class="code-line">フィルタ係数の見た目です。</p>
<figure>
<img src="img/ndboct/n_dB_oct_cofficients.png" alt="Image of the filter coefficients." style="width: 480px;"/>
</figure>
<p data-line="148" class="code-line">フィルタの周波数応答です。作った特性と一致します。</p>
<figure>
<img src="img/ndboct/n_dB_oct_response.png" alt="Image of frequency response of the filter." style="width: 480px;"/>
</figure>
<p data-line="154" class="code-line">不連続点を拡大すると<a href="https://en.wikipedia.org/wiki/Gibbs_phenomenon">ギブス現象</a>が観察できます。</p>
<pre class="hljs"><code><div>showResponse(sample_rate, filt)
</div></code></pre>
<figure>
<img src="img/ndboct/n_dB_oct_response_gibbs.png" alt="Image of gibbs phenomenon." style="width: 593px;"/>
</figure>
<p data-line="165" class="code-line">図の左は周波数軸が対数でないときのフィルタの周波数応答です。右上は低域側の不連続点、右下は高域側の不連続点を拡大したものです。</p>
<p data-line="167" class="code-line">フィルタができたので、ノイズを作ってかけてみます。</p>
<pre class="hljs"><code><div><span class="hljs-comment"># フィルタをノイズに適用。</span>
noise = np.random.uniform(<span class="hljs-number">-1.0</span>, <span class="hljs-number">1.0</span>, sample_rate)
p.title(<span class="hljs-string">'Before'</span>)
p.xscale(<span class="hljs-string">'log'</span>)
showResponse(sample_rate, noise)

filtered = signal.convolve(noise, filt, mode=<span class="hljs-string">'same'</span>)
p.title(<span class="hljs-string">'After'</span>)
p.xscale(<span class="hljs-string">'log'</span>)
showResponse(sample_rate, filtered)
</div></code></pre>
<p data-line="182" class="code-line">フィルタをかける前とかけた後のスペクトラムです。</p>
<figure>
<img src="img/ndboct/n_dB_oct_noise_and_filtered_response.png" alt="Image of frequency response of the filter." style="width: 612px;"/>
</figure>
<h2 data-line="188" class="code-line" id="%E5%BC%8F%E3%82%92%E9%80%94%E4%B8%AD%E3%81%BE%E3%81%A7%E8%A7%A3%E3%81%8F">式を途中まで解く</h2>
<p data-line="189" class="code-line"><a href="https://math.stackexchange.com/questions/935405/what-s-the-difference-between-analytical-and-numerical-approaches-to-problems">解析解</a>について調べます。</p>
<p data-line="191" class="code-line">問題を再掲します。</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>A</mi><mo>(</mo><mi>ω</mi><mo>)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>(</mo><mi>l</mi><mi mathvariant="normal">/</mi><mi>h</mi><msup><mo>)</mo><mi>M</mi></msup><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>(</mo><mo>−</mo><mi>π</mi><mo>≤</mo><mi>ω</mi><mo>≤</mo><mo>−</mo><mi>h</mi><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>(</mo><mi>ω</mi><mi mathvariant="normal">/</mi><mi>l</mi><msup><mo>)</mo><mi>M</mi></msup><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>(</mo><mo>−</mo><mi>h</mi><mo>&lt;</mo><mi>ω</mi><mo>&lt;</mo><mo>−</mo><mi>l</mi><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>(</mo><mo>−</mo><mi>l</mi><mo>≤</mo><mi>ω</mi><mo>≤</mo><mi>l</mi><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>(</mo><mi>ω</mi><mi mathvariant="normal">/</mi><mi>l</mi><msup><mo>)</mo><mi>M</mi></msup><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>(</mo><mi>l</mi><mo>&lt;</mo><mi>ω</mi><mo>&lt;</mo><mi>h</mi><mo>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>(</mo><mi>l</mi><mi mathvariant="normal">/</mi><mi>h</mi><msup><mo>)</mo><mi>M</mi></msup><mo separator="true">,</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>(</mo><mi>h</mi><mo>≤</mo><mi>ω</mi><mo>≤</mo><mi>π</mi><mo>)</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>M</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mspace width="0.16667em"></mspace><mi>m</mi></mrow><mrow><mn>2</mn><mn>0</mn></mrow></mfrac></mrow><msub><mi>log</mi><mn>2</mn></msub><mn>1</mn><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\begin{aligned}
A(\omega) &amp;=
\begin{cases}
(l/h)^{M}, &amp;  (-\pi \leq \omega \leq -h) \\
(\omega/l)^{M}, &amp;  (-h \lt \omega \lt -l) \\
1, &amp; (-l \leq \omega \leq l) \\
(\omega/l)^{M}, &amp; (l \lt \omega \lt h) \\
(l/h)^{M}, &amp; (h \leq \omega \leq \pi)
\end{cases} \\\\
M &amp;= {{\,m}\over{20}}\log_2 10
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:5.7968em;"></span><span class="strut bottom" style="height:11.0936em;vertical-align:-5.2968em;"></span><span class="base"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.7968em;"><span style="top:-7.7968em;"><span class="pstrut" style="height:5.85002em;"></span><span class="mord"><span class="mord mathit">A</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span></span></span><span style="top:-3.30678em;"><span class="pstrut" style="height:5.85002em;"></span><span class="mord"></span></span><span style="top:-1.5392199999999998em;"><span class="pstrut" style="height:5.85002em;"></span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.2968em;"></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.7968em;"><span style="top:-7.7968em;"><span class="pstrut" style="height:5.85002em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.8500199999999998em;"><span style="top:-0.6999900000000001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-0.6999900000000001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-0.9999899999999999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.29999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.59999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-1.89999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-2.19999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-3.1500100000000004em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.30001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.60001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.90001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.200010000000001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.50001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-5.80001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-6.100019999999999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.3500199999999998em;"></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.8500000000000005em;"><span style="top:-5.850000000000001em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathrm">/</span><span class="mord mathit">h</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span></span></span><span style="top:-4.410000000000001em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mord mathrm">/</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span></span></span><span style="top:-2.9700000000000006em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathrm">1</span><span class="mpunct">,</span></span></span><span style="top:-1.5300000000000002em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mord mathrm">/</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span></span></span><span style="top:-0.08999999999999997em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathrm">/</span><span class="mord mathit">h</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.35em;"></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.8500000000000005em;"><span style="top:-5.850000000000001em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">−</span><span class="mord mathit" style="margin-right:0.03588em;">π</span><span class="mrel">≤</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mrel">≤</span><span class="mord">−</span><span class="mord mathit">h</span><span class="mclose">)</span></span></span><span style="top:-4.410000000000001em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">−</span><span class="mord mathit">h</span><span class="mrel">&lt;</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mrel">&lt;</span><span class="mord">−</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mclose">)</span></span></span><span style="top:-2.9700000000000006em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">−</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mrel">≤</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mrel">≤</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mclose">)</span></span></span><span style="top:-1.5300000000000002em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mrel">&lt;</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mrel">&lt;</span><span class="mord mathit">h</span><span class="mclose">)</span></span></span><span style="top:-0.08999999999999997em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathit">h</span><span class="mrel">≤</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mrel">≤</span><span class="mord mathit" style="margin-right:0.03588em;">π</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.35em;"></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-1.5392199999999998em;"><span class="pstrut" style="height:5.85002em;"></span><span class="mord"><span class="mord"></span><span class="mrel">=</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">2</span><span class="mord mathrm">0</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"></span></span></span></span></span><span class="mord mathrm">1</span><span class="mord mathrm">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:5.2968em;"></span></span></span></span></span></span></span></span></span></span></eqn></section><p data-line="207" class="code-line"><eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>(</mo><mi>ω</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">A(\omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathit">A</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span></span></span></span></eq> を<a href="https://en.wikipedia.org/wiki/Discrete-time_Fourier_transform#Inverse_transform">逆DTFT</a>の式に入れてMaximaで解きます。</p>
<pre class="hljs"><code><div><span class="hljs-comment">/* Maxima */</span>
<span class="hljs-built_in">expintrep</span>: <span class="hljs-literal">true</span>;
<span class="hljs-built_in">expintexpand</span>: <span class="hljs-literal">true</span>;
<span class="hljs-built_in">declare</span>(n, <span class="hljs-built_in">integer</span>, M, <span class="hljs-built_in">real</span>, l, <span class="hljs-built_in">real</span>, h, <span class="hljs-built_in">real</span>);
<span class="hljs-built_in">assume</span>(n &gt; <span class="hljs-number">0</span>, l &gt;= <span class="hljs-number">0</span>, l &lt;= pi, h &gt;= <span class="hljs-number">0</span>, h &lt;= pi, h &gt; l);

oct(m, l, h) := (h / l)**(M);

O: <span class="hljs-built_in">integrate</span>(oct(m, l, h) * <span class="hljs-built_in">exp</span>(<span class="hljs-literal">%i</span>*omega*n), omega, -pi, -h);
P: <span class="hljs-built_in">integrate</span>(oct(m, l, omega) * <span class="hljs-built_in">exp</span>(<span class="hljs-literal">%i</span>*omega*n), omega, -h, -l);
Q: <span class="hljs-built_in">integrate</span>(<span class="hljs-built_in">exp</span>(<span class="hljs-literal">%i</span>*omega*n), omega, -l, l);
R: <span class="hljs-built_in">integrate</span>(oct(m, l, omega) * <span class="hljs-built_in">exp</span>(<span class="hljs-literal">%i</span>*omega*n), omega, l, h);
S: <span class="hljs-built_in">integrate</span>(oct(m, l, h) * <span class="hljs-built_in">exp</span>(<span class="hljs-literal">%i</span>*omega*n), omega, h, pi);
answer: <span class="hljs-built_in">expand</span>(<span class="hljs-built_in">demoivre</span>((O + P + Q + R + S) / (<span class="hljs-number">2</span>*pi)));

<span class="hljs-comment">/* where */</span>
M: <span class="hljs-built_in">log</span>(<span class="hljs-number">10</span>)*m/<span class="hljs-number">20</span>/<span class="hljs-built_in">log</span>(<span class="hljs-number">2</span>);
</div></code></pre>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn><mi>π</mi></mrow></mfrac><msubsup><mo>∫</mo><mrow><mo>−</mo><mi>π</mi></mrow><mi>π</mi></msubsup><mi>A</mi><mo>(</mo><mi>ω</mi><mo>)</mo><msup><mi>e</mi><mrow><mi>j</mi><mi>ω</mi><mi>n</mi></mrow></msup><mi>d</mi><mi>ω</mi><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mrow><mfrac><mrow><msup><mi>h</mi><mi>M</mi></msup></mrow><mrow><msup><mi>l</mi><mi>M</mi></msup></mrow></mfrac></mrow><msubsup><mo>∫</mo><mrow><mo>−</mo><mi>π</mi></mrow><mrow><mo>−</mo><mi>h</mi></mrow></msubsup><mrow><msup><mi>e</mi><mrow><mi>i</mi><mspace width="0.16667em"></mspace><mi>n</mi><mspace width="0.16667em"></mspace><mi>ω</mi></mrow></msup><mspace width="0.277778em"></mspace><mi>d</mi><mi>ω</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>+</mo><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><msup><mi>l</mi><mi>M</mi></msup></mrow></mfrac></mrow><msubsup><mo>∫</mo><mrow><mo>−</mo><mi>h</mi></mrow><mrow><mo>−</mo><mi>l</mi></mrow></msubsup><mrow><msup><mi>ω</mi><mi>M</mi></msup><mspace width="0.16667em"></mspace><msup><mi>e</mi><mrow><mi>i</mi><mspace width="0.16667em"></mspace><mi>n</mi><mspace width="0.16667em"></mspace><mi>ω</mi></mrow></msup><mspace width="0.277778em"></mspace><mi>d</mi><mi>ω</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>+</mo><msubsup><mo>∫</mo><mrow><mo>−</mo><mi>l</mi></mrow><mi>l</mi></msubsup><mrow><msup><mi>e</mi><mrow><mi>i</mi><mspace width="0.16667em"></mspace><mi>n</mi><mspace width="0.16667em"></mspace><mi>ω</mi></mrow></msup><mspace width="0.277778em"></mspace><mi>d</mi><mi>ω</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>+</mo><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><msup><mi>l</mi><mi>M</mi></msup></mrow></mfrac></mrow><msubsup><mo>∫</mo><mi>l</mi><mi>h</mi></msubsup><mrow><msup><mi>ω</mi><mi>M</mi></msup><mspace width="0.16667em"></mspace><msup><mi>e</mi><mrow><mi>i</mi><mspace width="0.16667em"></mspace><mi>n</mi><mspace width="0.16667em"></mspace><mi>ω</mi></mrow></msup><mspace width="0.277778em"></mspace><mi>d</mi><mi>ω</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>+</mo><mrow><mfrac><mrow><msup><mi>h</mi><mi>M</mi></msup></mrow><mrow><msup><mi>l</mi><mi>M</mi></msup></mrow></mfrac></mrow><msubsup><mo>∫</mo><mi>h</mi><mi>π</mi></msubsup><mrow><msup><mi>e</mi><mrow><mi>i</mi><mspace width="0.16667em"></mspace><mi>n</mi><mspace width="0.16667em"></mspace><mi>ω</mi></mrow></msup><mspace width="0.277778em"></mspace><mi>d</mi><mi>ω</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mrow><mfrac><mrow><mi>sin</mi><mrow><mo fence="true">(</mo><mi>l</mi><mspace width="0.16667em"></mspace><mi>n</mi><mo fence="true">)</mo></mrow></mrow><mrow><mi>n</mi><mspace width="0.16667em"></mspace><mi>π</mi></mrow></mfrac></mrow><mo>+</mo><mrow><mfrac><mrow><msup><mi>h</mi><mi>M</mi></msup><mspace width="0.16667em"></mspace><mi>sin</mi><mrow><mo fence="true">(</mo><mi>n</mi><mspace width="0.16667em"></mspace><mi>π</mi><mo fence="true">)</mo></mrow></mrow><mrow><msup><mi>l</mi><mi>M</mi></msup><mspace width="0.16667em"></mspace><mi>n</mi><mspace width="0.16667em"></mspace><mi>π</mi></mrow></mfrac></mrow><mo>−</mo><mrow><mfrac><mrow><msup><mi>h</mi><mi>M</mi></msup><mspace width="0.16667em"></mspace><mi>sin</mi><mrow><mo fence="true">(</mo><mi>h</mi><mspace width="0.16667em"></mspace><mi>n</mi><mo fence="true">)</mo></mrow></mrow><mrow><msup><mi>l</mi><mi>M</mi></msup><mspace width="0.16667em"></mspace><mi>n</mi><mspace width="0.16667em"></mspace><mi>π</mi></mrow></mfrac></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>+</mo><mrow><mfrac><mrow><mi>i</mi><mspace width="0.16667em"></mspace><msup><mrow><mo fence="true">(</mo><mo>−</mo><mn>1</mn><mo fence="true">)</mo></mrow><mrow><mfrac><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></mfrac></mrow></msup><msup><mi>n</mi><mrow><mo>−</mo><mi>M</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><mrow><mn>2</mn><mspace width="0.16667em"></mspace><mi>π</mi><mspace width="0.16667em"></mspace><msup><mi>l</mi><mi>M</mi></msup></mrow></mfrac></mrow><mo fence="true">(</mo><mi mathvariant="normal">Γ</mi><mrow><mo fence="true">(</mo><mi>M</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mspace width="0.16667em"></mspace><mi>h</mi><mspace width="0.16667em"></mspace><mi>n</mi><mo fence="true">)</mo></mrow><mo>−</mo><mi mathvariant="normal">Γ</mi><mrow><mo fence="true">(</mo><mi>M</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mspace width="0.16667em"></mspace><mi>l</mi><mspace width="0.16667em"></mspace><mi>n</mi><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>+</mo><mrow><mfrac><mrow><mi>i</mi><mspace width="0.16667em"></mspace><msup><mrow><mo fence="true">(</mo><mo>−</mo><mi>i</mi><mo fence="true">)</mo></mrow><mrow><mo>−</mo><mi>M</mi></mrow></msup><mspace width="0.16667em"></mspace><msup><mi>n</mi><mrow><mo>−</mo><mi>M</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><mrow><mn>2</mn><mspace width="0.16667em"></mspace><mi>π</mi><mspace width="0.16667em"></mspace><msup><mi>l</mi><mi>M</mi></msup></mrow></mfrac></mrow><mo fence="true">(</mo><mi mathvariant="normal">Γ</mi><mrow><mo fence="true">(</mo><mi>M</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mo>−</mo><mi>i</mi><mspace width="0.16667em"></mspace><mi>l</mi><mspace width="0.16667em"></mspace><mi>n</mi><mo fence="true">)</mo></mrow><mo>−</mo><mi mathvariant="normal">Γ</mi><mrow><mo fence="true">(</mo><mi>M</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mo>−</mo><mi>i</mi><mspace width="0.16667em"></mspace><mi>h</mi><mspace width="0.16667em"></mspace><mi>n</mi><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\begin{aligned}
\frac{1}{2\pi}\int^{\pi}_{-\pi} A(\omega) e^{j\omega n} d\omega

=

&amp;{{h^{M}}\over{l^{M}}}\int_{-\pi}^{-h}{e^{i\,n\,\omega}\;d\omega}\\
&amp;+{{1}\over{l^{M}}}\int_{-h}^{-l}{\omega^{M}\,e^{i\,n\,\omega}\;d\omega}\\
&amp;+\int_{-l}^{l}{e^{i\,n\,\omega}\;d\omega}\\
&amp;+{{1}\over{l^{M}}}\int_{l}^{h}{\omega^{M}\,e^{i\,n\,\omega}\;d\omega}\\
&amp;+{{h^{M}}\over{l^{M}}}\int_{h}^{\pi}{e^{i\,n\,\omega}\;d\omega}\\

=

&amp;{{\sin \left(l\,n\right)}\over{n\,\pi}}
+{{h^{M}\,\sin \left(n\,\pi\right)}\over{l^{M}\,n\,\pi}}
-{{h^{M}\,\sin \left(h\,n\right)}\over{l^{M}\,n\,\pi}}\\

&amp;+{{i\,\left(-1\right)^{{{M}\over{2}}} n^{-M-1}}\over{2\,\pi\,l^{M}}}
\Bigl(\Gamma\left(M+1 , i\,h\,n\right) - \Gamma\left(M+1 , i\,l\,n\right)\Bigr)\\

&amp;+{{i\,\left(-i\right)^{-M}\,n^{-M-1}}\over{2\,\pi\,l^{M}}}
\Bigl(\Gamma\left(M+1 , -i\,l\,n\right) - \Gamma\left(M+1 , -i\,h\,n\right)\Bigr)
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:11.287016500000002em;"></span><span class="strut bottom" style="height:22.074033000000004em;vertical-align:-10.787016500000002em;"></span><span class="base"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:11.287016500000002em;"><span style="top:-13.478373500000002em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">2</span><span class="mord mathit" style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.414292em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight" style="margin-right:0.03588em;">π</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.970281em;"></span></span></span></span></span><span class="mord mathit">A</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.874664em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span><span class="mord mathit mtight" style="margin-right:0.03588em;">ω</span><span class="mord mathit mtight">n</span></span></span></span></span></span></span></span></span><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mrel">=</span></span></span><span style="top:-10.609084500000002em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"></span></span><span style="top:-7.7397955000000005em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"></span></span><span style="top:-4.870506500000001em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"></span></span><span style="top:-2.140225500000002em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"></span></span><span style="top:0.5900554999999984em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"><span class="mrel">=</span></span></span><span style="top:3.3664205000000007em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"></span></span><span style="top:6.0106515000000025em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:10.787016500000002em;"></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:11.287016500000002em;"><span style="top:-13.478373500000002em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183309999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.767331em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5990080000000002em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight" style="margin-right:0.03588em;">π</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.970281em;"></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight"><span class="mspace thinspace mtight"></span><span class="mord mathit mtight">n</span></span><span class="mord mathit mtight"><span class="mspace thinspace mtight"></span><span class="mord mathit mtight" style="margin-right:0.03588em;">ω</span></span></span></span></span></span></span></span></span></span><span class="mord mathit"><span class="mspace thickspace"></span><span class="mord mathit">d</span></span><span class="mord mathit" style="margin-right:0.03588em;">ω</span></span></span></span><span style="top:-10.609084500000002em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"><span class="mord"></span><span class="mbin">+</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.767331em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5990080000000002em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight">h</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.970281em;"></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mspace thinspace"></span><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight"><span class="mspace thinspace mtight"></span><span class="mord mathit mtight">n</span></span><span class="mord mathit mtight"><span class="mspace thinspace mtight"></span><span class="mord mathit mtight" style="margin-right:0.03588em;">ω</span></span></span></span></span></span></span></span></span></span><span class="mord mathit"><span class="mspace thickspace"></span><span class="mord mathit">d</span></span><span class="mord mathit" style="margin-right:0.03588em;">ω</span></span></span></span><span style="top:-7.7397955000000005em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"><span class="mord"></span><span class="mbin">+</span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5990080000000002em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight" style="margin-right:0.01968em;">l</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.970281em;"></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight"><span class="mspace thinspace mtight"></span><span class="mord mathit mtight">n</span></span><span class="mord mathit mtight"><span class="mspace thinspace mtight"></span><span class="mord mathit mtight" style="margin-right:0.03588em;">ω</span></span></span></span></span></span></span></span></span></span><span class="mord mathit"><span class="mspace thickspace"></span><span class="mord mathit">d</span></span><span class="mord mathit" style="margin-right:0.03588em;">ω</span></span></span></span><span style="top:-4.870506500000001em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"><span class="mord"></span><span class="mbin">+</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.767331em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5990080000000002em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.01968em;">l</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119499999999999em;"></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mspace thinspace"></span><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight"><span class="mspace thinspace mtight"></span><span class="mord mathit mtight">n</span></span><span class="mord mathit mtight"><span class="mspace thinspace mtight"></span><span class="mord mathit mtight" style="margin-right:0.03588em;">ω</span></span></span></span></span></span></span></span></span></span><span class="mord mathit"><span class="mspace thickspace"></span><span class="mord mathit">d</span></span><span class="mord mathit" style="margin-right:0.03588em;">ω</span></span></span></span><span style="top:-2.140225500000002em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"><span class="mord"></span><span class="mbin">+</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183309999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.767331em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.414292em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">h</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119499999999999em;"></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8746639999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight"><span class="mspace thinspace mtight"></span><span class="mord mathit mtight">n</span></span><span class="mord mathit mtight"><span class="mspace thinspace mtight"></span><span class="mord mathit mtight" style="margin-right:0.03588em;">ω</span></span></span></span></span></span></span></span></span></span><span class="mord mathit"><span class="mspace thickspace"></span><span class="mord mathit">d</span></span><span class="mord mathit" style="margin-right:0.03588em;">ω</span></span></span></span><span style="top:0.5900554999999984em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">n</span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit" style="margin-right:0.03588em;">π</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">sin</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">n</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183309999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.767331em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">n</span></span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit" style="margin-right:0.03588em;">π</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span><span class="mop"><span class="mspace thinspace"></span>sin</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathit">n</span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit" style="margin-right:0.03588em;">π</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mbin">−</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183309999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.767331em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">n</span></span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit" style="margin-right:0.03588em;">π</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span><span class="mop"><span class="mspace thinspace"></span>sin</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathit">h</span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">n</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span style="top:3.3664205000000007em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"><span class="mord"></span><span class="mbin">+</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.790365em;"><span style="top:-2.427365em;"><span class="pstrut" style="height:3.113365em;"></span><span class="mord"><span class="mord mathrm">2</span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit" style="margin-right:0.03588em;">π</span></span><span class="mord"><span class="mspace thinspace"></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.767331em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.343365em;"><span class="pstrut" style="height:3.113365em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.790365em;"><span class="pstrut" style="height:3.113365em;"></span><span class="mord"><span class="mord mathit">i</span><span class="minner"><span class="mspace thinspace"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">−</span><span class="mord mathrm">1</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.113365em;"><span style="top:-3.5029000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8720928571428572em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathrm mtight">2</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathit">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span><span class="mbin mtight">−</span><span class="mord mathrm mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mopen"><span class="delimsizing size2">(</span></span><span class="mord mathrm">Γ</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">h</span></span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">n</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mbin">−</span><span class="mord mathrm">Γ</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit" style="margin-right:0.01968em;">l</span></span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">n</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose"><span class="delimsizing size2">)</span></span></span></span><span style="top:6.0106515000000025em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"><span class="mord"></span><span class="mbin">+</span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.658231em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">2</span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit" style="margin-right:0.03588em;">π</span></span><span class="mord"><span class="mspace thinspace"></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.767331em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">i</span><span class="minner"><span class="mspace thinspace"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">−</span><span class="mord mathit">i</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mspace thinspace"></span><span class="mord mathit">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span><span class="mbin mtight">−</span><span class="mord mathrm mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mopen"><span class="delimsizing size2">(</span></span><span class="mord mathrm">Γ</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord">−</span><span class="mord mathit">i</span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit" style="margin-right:0.01968em;">l</span></span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">n</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mbin">−</span><span class="mord mathrm">Γ</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord">−</span><span class="mord mathit">i</span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">h</span></span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">n</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose"><span class="delimsizing size2">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:10.787016500000002em;"></span></span></span></span></span></span></span></span></span></span></eqn></section><p data-line="255" class="code-line"><eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Γ</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\Gamma(s, x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathrm">Γ</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></eq> は <a href="https://en.wikipedia.org/wiki/Incomplete_gamma_function#Definition">upper incomplete gamma function</a> です。</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Γ</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo>)</mo><mo>=</mo><msubsup><mo>∫</mo><mi>x</mi><mi mathvariant="normal">∞</mi></msubsup><msup><mi>t</mi><mrow><mi>s</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>e</mi><mrow><mo>−</mo><mi>t</mi></mrow></msup><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">
\Gamma(s, x) = \int_{x}^{\infty} t^{s - 1} e^{-t} dt
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.4142920000000005em;"></span><span class="strut bottom" style="height:2.3262420000000006em;vertical-align:-0.9119499999999999em;"></span><span class="base"><span class="mord mathrm">Γ</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4142920000000005em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">x</span></span></span></span><span style="top:-3.812900000000001em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119499999999999em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mbin mtight">−</span><span class="mord mathrm mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight">t</span></span></span></span></span></span></span></span></span><span class="mord mathit">d</span><span class="mord mathit">t</span></span></span></span></span></eqn></section><p data-line="261" class="code-line"><eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Γ</mi><mo>(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\Gamma(s, x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathrm">Γ</span><span class="mopen">(</span><span class="mord mathit">s</span><span class="mpunct">,</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></eq> がどこから出てきたのかを確認するために、Maximaのコードで定義したP式とR式に注目します。</p>
<pre class="hljs"><code><div>oct(m, l, h) := (h / l)**(M);
<span class="hljs-built_in">assume</span>(n &gt; <span class="hljs-number">0</span>, l &gt;= <span class="hljs-number">0</span>, l &lt;= pi, h &gt;= <span class="hljs-number">0</span>, h &lt;= pi, h &gt; l);
P: <span class="hljs-built_in">integrate</span>(oct(m, l, omega) * <span class="hljs-built_in">exp</span>(<span class="hljs-literal">%i</span>*omega*n), omega, -h, -l);
R: <span class="hljs-built_in">integrate</span>(oct(m, l, omega) * <span class="hljs-built_in">exp</span>(<span class="hljs-literal">%i</span>*omega*n), omega, l, h);
</div></code></pre>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msubsup><mo>∫</mo><mrow><mo>−</mo><mi>π</mi></mrow><mi>π</mi></msubsup><msub><mi>A</mi><mi>P</mi></msub><mo>(</mo><mi>ω</mi><mo>)</mo><msup><mi>e</mi><mrow><mi>j</mi><mi>ω</mi><mi>n</mi></mrow></msup><mi>d</mi><mi>ω</mi><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mrow><mfrac><mrow><mi>i</mi><mspace width="0.16667em"></mspace><msup><mrow><mo fence="true">(</mo><mo>−</mo><mn>1</mn><mo fence="true">)</mo></mrow><mrow><mfrac><mrow><mi>M</mi></mrow><mrow><mn>2</mn></mrow></mfrac></mrow></msup><msup><mi>n</mi><mrow><mo>−</mo><mi>M</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><mrow><mn>2</mn><mspace width="0.16667em"></mspace><mi>π</mi><mspace width="0.16667em"></mspace><msup><mi>l</mi><mi>M</mi></msup></mrow></mfrac></mrow><mo fence="true">(</mo><mi mathvariant="normal">Γ</mi><mrow><mo fence="true">(</mo><mi>M</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mspace width="0.16667em"></mspace><mi>h</mi><mspace width="0.16667em"></mspace><mi>n</mi><mo fence="true">)</mo></mrow><mo>−</mo><mi mathvariant="normal">Γ</mi><mrow><mo fence="true">(</mo><mi>M</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mspace width="0.16667em"></mspace><mi>l</mi><mspace width="0.16667em"></mspace><mi>n</mi><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msubsup><mo>∫</mo><mrow><mo>−</mo><mi>π</mi></mrow><mi>π</mi></msubsup><msub><mi>A</mi><mi>R</mi></msub><mo>(</mo><mi>ω</mi><mo>)</mo><msup><mi>e</mi><mrow><mi>j</mi><mi>ω</mi><mi>n</mi></mrow></msup><mi>d</mi><mi>ω</mi><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mrow><mfrac><mrow><mi>i</mi><mspace width="0.16667em"></mspace><msup><mrow><mo fence="true">(</mo><mo>−</mo><mi>i</mi><mo fence="true">)</mo></mrow><mrow><mo>−</mo><mi>M</mi></mrow></msup><mspace width="0.16667em"></mspace><msup><mi>n</mi><mrow><mo>−</mo><mi>M</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><mrow><mn>2</mn><mspace width="0.16667em"></mspace><mi>π</mi><mspace width="0.16667em"></mspace><msup><mi>l</mi><mi>M</mi></msup></mrow></mfrac></mrow><mo fence="true">(</mo><mi mathvariant="normal">Γ</mi><mrow><mo fence="true">(</mo><mi>M</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mo>−</mo><mi>i</mi><mspace width="0.16667em"></mspace><mi>l</mi><mspace width="0.16667em"></mspace><mi>n</mi><mo fence="true">)</mo></mrow><mo>−</mo><mi mathvariant="normal">Γ</mi><mrow><mo fence="true">(</mo><mi>M</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mo>−</mo><mi>i</mi><mspace width="0.16667em"></mspace><mi>h</mi><mspace width="0.16667em"></mspace><mi>n</mi><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\begin{aligned}
\int^{\pi}_{-\pi} A_P(\omega) e^{j\omega n} d\omega
=
&amp;{{i\,\left(-1\right)^{{{M}\over{2}}} n^{-M-1}}\over{2\,\pi\,l^{M}}}
\Bigl(\Gamma\left(M+1 , i\,h\,n\right) - \Gamma\left(M+1 , i\,l\,n\right)\Bigr)\\

\int^{\pi}_{-\pi} A_R(\omega) e^{j\omega n} d\omega
=
&amp;{{i\,\left(-i\right)^{-M}\,n^{-M-1}}\over{2\,\pi\,l^{M}}}
\Bigl(\Gamma\left(M+1 , -i\,l\,n\right) - \Gamma\left(M+1 , -i\,h\,n\right)\Bigr)
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:3.244579em;"></span><span class="strut bottom" style="height:5.989158em;vertical-align:-2.744579em;"></span><span class="base"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.244579em;"><span style="top:-5.244579em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.414292em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight" style="margin-right:0.03588em;">π</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.970281em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">P</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.874664em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span><span class="mord mathit mtight" style="margin-right:0.03588em;">ω</span><span class="mord mathit mtight">n</span></span></span></span></span></span></span></span></span><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mrel">=</span></span></span><span style="top:-2.3160670000000003em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.414292em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight" style="margin-right:0.03588em;">π</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">π</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.970281em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"></span></span></span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mclose">)</span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.874664em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span><span class="mord mathit mtight" style="margin-right:0.03588em;">ω</span><span class="mord mathit mtight">n</span></span></span></span></span></span></span></span></span><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mrel">=</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.744579em;"></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.244579em;"><span style="top:-5.244579em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.790365em;"><span style="top:-2.427365em;"><span class="pstrut" style="height:3.113365em;"></span><span class="mord"><span class="mord mathrm">2</span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit" style="margin-right:0.03588em;">π</span></span><span class="mord"><span class="mspace thinspace"></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.767331em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.343365em;"><span class="pstrut" style="height:3.113365em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.790365em;"><span class="pstrut" style="height:3.113365em;"></span><span class="mord"><span class="mord mathit">i</span><span class="minner"><span class="mspace thinspace"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">−</span><span class="mord mathrm">1</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.113365em;"><span style="top:-3.5029000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8720928571428572em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathrm mtight">2</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathit">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span><span class="mbin mtight">−</span><span class="mord mathrm mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mopen"><span class="delimsizing size2">(</span></span><span class="mord mathrm">Γ</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">h</span></span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">n</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mbin">−</span><span class="mord mathrm">Γ</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit" style="margin-right:0.01968em;">l</span></span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">n</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose"><span class="delimsizing size2">)</span></span></span></span><span style="top:-2.3160670000000003em;"><span class="pstrut" style="height:3.790365em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.658231em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathrm">2</span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit" style="margin-right:0.03588em;">π</span></span><span class="mord"><span class="mspace thinspace"></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.767331em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathit">i</span><span class="minner"><span class="mspace thinspace"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">−</span><span class="mord mathit">i</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.981231em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mspace thinspace"></span><span class="mord mathit">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span><span class="mbin mtight">−</span><span class="mord mathrm mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mopen"><span class="delimsizing size2">(</span></span><span class="mord mathrm">Γ</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord">−</span><span class="mord mathit">i</span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit" style="margin-right:0.01968em;">l</span></span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">n</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mbin">−</span><span class="mord mathrm">Γ</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord">−</span><span class="mord mathit">i</span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">h</span></span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">n</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mclose"><span class="delimsizing size2">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.744579em;"></span></span></span></span></span></span></span></span></span></span></eqn></section><p data-line="284" class="code-line">適当に <eq><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Γ</mi><mrow><mo fence="true">(</mo><mi>M</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mspace width="0.16667em"></mspace><mi>h</mi><mspace width="0.16667em"></mspace><mi>n</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Gamma\left(M+1 , i\,h\,n\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base"><span class="mord mathrm">Γ</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">h</span></span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">n</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></eq> を展開します。</p>
<section><eqn><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Γ</mi><mrow><mo fence="true">(</mo><mi>M</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mspace width="0.16667em"></mspace><mi>h</mi><mspace width="0.16667em"></mspace><mi>n</mi><mo fence="true">)</mo></mrow><mo>=</mo><msubsup><mo>∫</mo><mrow><mi>i</mi><mspace width="0.16667em"></mspace><mi>h</mi><mspace width="0.16667em"></mspace><mi>n</mi></mrow><mi mathvariant="normal">∞</mi></msubsup><msup><mi>t</mi><mi>M</mi></msup><msup><mi>e</mi><mrow><mo>−</mo><mi>t</mi></mrow></msup><mi>d</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">
\Gamma\left(M+1 , i\,h\,n\right) = \int_{i\,h\,n}^{\infty} t^{M} e^{-t} dt
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.414292em;"></span><span class="strut bottom" style="height:2.326242em;vertical-align:-0.9119499999999999em;"></span><span class="base"><span class="mord mathrm">Γ</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">h</span></span><span class="mord mathit"><span class="mspace thinspace"></span><span class="mord mathit">n</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mrel">=</span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.414292em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight"><span class="mspace thinspace mtight"></span><span class="mord mathit mtight">h</span></span><span class="mord mathit mtight"><span class="mspace thinspace mtight"></span><span class="mord mathit mtight">n</span></span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">∞</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119499999999999em;"></span></span></span></span></span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight">t</span></span></span></span></span></span></span></span></span><span class="mord mathit">d</span><span class="mord mathit">t</span></span></span></span></span></eqn></section><p data-line="290" class="code-line"><a href="https://en.wikipedia.org/wiki/Line_integral#Complex_line_integral">複素数の線積分</a>に見えます。</p>
<h2 data-line="292" class="code-line" id="%E5%8F%82%E8%80%83%E3%82%B5%E3%82%A4%E3%83%88">参考サイト</h2>
<ul>
<li data-line="293" class="code-line"><a href="http://maxima.sourceforge.net/docs/manual/maxima_11.html#declare">Maxima 5.41.0 Manual: 11. Maximas Database</a>
<ul>
<li data-line="294" class="code-line">Maxima の declare。</li>
</ul>
</li>
<li data-line="295" class="code-line"><a href="https://stackoverflow.com/questions/14291119/stop-maxima-from-asking-positive-negative-or-zero">Stop maxima from asking positive, negative or zero - Stack Overflow</a>
<ul>
<li data-line="296" class="code-line">Maxima の assume。</li>
</ul>
</li>
<li data-line="297" class="code-line"><a href="http://maxima.sourceforge.net/docs/manual/maxima_15.html">Maxima 5.41.0 Manual: 15. Special Functions</a></li>
<li data-line="298" class="code-line"><a href="https://en.wikipedia.org/wiki/Exponential_integral">Exponential integral - Wikipedia</a>
<ul>
<li data-line="299" class="code-line">Incomplete gamma function と関連。</li>
</ul>
</li>
</ul>

</body></html>